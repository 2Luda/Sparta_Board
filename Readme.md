# **스프링 숙련 주차 개인과제 Lv2**

### **요구 사항**
1. 회원 가입 API
    - username, password를 Client에서 전달받기
    - username은  `최소 4자 이상, 10자 이하이며 알파벳 소문자(a~z), 숫자(0~9)`로 구성되어야 한다.
    - password는  `최소 8자 이상, 15자 이하이며 알파벳 대소문자(a~z, A~Z), 숫자(0~9), 특수문자`로 구성되어야 한다.
    - DB에 중복된 username이 없다면 회원을 저장하고 Client 로 성공했다는 메시지, 상태코드 반환하기
    - 회원 권한 부여하기 (ADMIN, USER) - ADMIN 회원은 모든 게시글, 댓글 수정 / 삭제 가능

2. 로그인 API
    - username, password를 Client에서 전달받기
    - DB에서 username을 사용하여 저장된 회원의 유무를 확인하고 있다면 password 비교하기
    - 로그인 성공 시, 로그인에 성공한 유저의 정보와 JWT를 활용하여 토큰을 발급하고,
      발급한 토큰을 Header에 추가하고 성공했다는 메시지, 상태코드 와 함께 Client에 반환하기
3. 댓글 작성 API
    - 토큰을 검사하여, 유효한 토큰일 경우에만 댓글 작성 가능
    - 선택한 게시글의 DB 저장 유무를 확인하기
    - 선택한 게시글이 있다면 댓글을 등록하고 등록된 댓글 반환하기
4. 댓글 수정 API
    - 토큰을 검사한 후, 유효한 토큰이면서 해당 사용자가 작성한 댓글만 수정 가능
    - 선택한 댓글의 DB 저장 유무를 확인하기
    - 선택한 댓글이 있다면 댓글 수정하고 수정된 댓글 반환하기
5. 댓글 삭제 API
    - 토큰을 검사한 후, 유효한 토큰이면서 해당 사용자가 작성한 댓글만 삭제 가능
    - 선택한 댓글의 DB 저장 유무를 확인하기
    - 선택한 댓글이 있다면 댓글 삭제하고 Client 로 성공했다는 메시지, 상태코드 반환하기
6. 예외 처리
    - 토큰이 필요한 API 요청에서 토큰을 전달하지 않았거나 정상 토큰이 아닐 때는 "토큰이 유효하지 않습니다." 라는 에러메시지와 statusCode: 400을 Client에 반환하기
    - 토큰이 있고, 유효한 토큰이지만 해당 사용자가 작성한 게시글/댓글이 아닌 경우에는 “작성자만 삭제/수정할 수 있습니다.”라는 에러메시지와 statusCode: 400을 Client에 반환하기
    - DB에 이미 존재하는 username으로 회원가입을 요청한 경우 "중복된 username 입니다." 라는 에러메시지와 statusCode: 400을 Client에 반환하기
    - 로그인 시, 전달된 username과 password 중 맞지 않는 정보가 있다면 "회원을 찾을 수 없습니다."라는 에러메시지와 statusCode: 400을 Client에 반환하기

### 기존 과제 Lv1 에서 수정 된 사항

1. 전체 게시글 목록 조회 API
- 각각의 게시글에 등록된 모든 댓글을 게시글과 같이 Client에 반환하기
- 댓글은 작성 날짜 기준 내림차순으로 정렬하기

2. 선택한 게시글 조회 API
- 선택한 게시글에 등록된 모든 댓글을 선택한 게시글과 같이 Client에 반환하기
- 댓글은 작성 날짜 기준 내림차순으로 정렬하기

### **API 명세서**

|    기능     | API URL                  | Method | Request Header                                                                                                                                                                         | Request                                                            | Response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Response Header                                                                                                                                                                        |
|:---------:|--------------------------|--------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|   회원 가입   | api/auth/signup          | POST   |                                                                                                                                                                                        | {<br/>"username" : "user1",<br/>"password" : "helloworld123!" }    | 가입 성공                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                        |
|    로그인    | /api/auth/login          | POST   |                                                                                                                                                                                        | {<br/>"username" : "user1",<br/>"password" : "helloworld123!" }    | 로그인 완료                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Authorization : Bearer eyJhbGciOiJIUzI1NiJ9.eyJzd<br/>WIiOiJ1c2VyMSIsImF1dGgiOiJVU0VSIiwiZXhwIjoxNjcyMTEzMDE5LCJpY<br/>XQiOjE2NzIxMDk0MTl9.hhddEesXd2HVb2CRl4SJZVJjspFRGRMG8yGi5QQcIXg |
|  게시글 작성   | /api/boards              | POST   | Authorization : Bearer eyJhbGciOiJIUzI1NiJ9.eyJzd<br/>WIiOiJ1c2VyMSIsImF1dGgiOiJVU0VSIiwiZXhwIjoxNjcyMTEzMDE5LCJpY<br/>XQiOjE2NzIxMDk0MTl9.hhddEesXd2HVb2CRl4SJZVJjspFRGRMG8yGi5QQcIXg | {    "title" : "테스트1",    "content" : "제목이 곧 내용"}                  | {<br/>"title": "테스트1",<br/>"content": "제목이 곧 내용",<br/>"username": "user1",<br/>"createdAt": "2022-12-27T11:52:16.828493",<br/>"modifiedAt": "2022-12-27T11:52:16.828493",<br/>"commentList": []<br/> }                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                        |
| 게시글 목록 조회 | /api/boards              | GET    |                                                                                                                                                                                        |                                                                    | [<br/>{<br/>"title": "테스트2",<br/>"username": "user1",<br/>"createdAt": "2022-12-27T11:53:40.606077",<br/>"modifiedAt": "2022-12-27T11:53:40.606077",<br/>"content": "제목이 곧 내용",<br/>"commentsList": []<br/>},<br/>{<br/>"title": "테스트1",<br/>"username": "user1",<br/>"createdAt": "2022-12-27T11:52:16.828493",<br/>"modifiedAt": "2022-12-27T11:52:16.828493",<br/>"content": "제목이 곧 내용",<br/>"commentsList": [<br/>{"comment": "댓글 작성",<br/>"createdAt": "2022-12-27T11:53:57.219415",<br/>"modifiedAt": "2022-12-27T11:53:57.219415",<br/>"id": 1,<br/>"username": "user1"<br/>}<br/>]<br/>}<br/>] |                                                                                                                                                                                        |
| 게시글 상세 조회 | /api/boards/{id}         | GET    |                                                                                                                                                                                        |                                                                    | {<br/>"title": "테스트1",<br/>"content": "제목이 곧 내용",<br/>"username": "user1",<br/>"createdAt": "2022-12-27T11:52:16.828493",<br/>"modifiedAt": "2022-12-27T11:52:16.828493",<br/>"commentList": [<br/>{"comment": "댓글 작성",<br/>"createdAt": "2022-12-27T11:53:57.219415",<br/>"modifiedAt": "2022-12-27T11:53:57.219415",<br/>"id": 1,<br/>"username": "user1"}<br/>]<br/>}                                                                                                                                                                                                                               |                                                                                                                                                                                        |
|  게시글 수정   | /api/boards/{id}         | PUT    | Authorization : Bearer eyJhbGciOiJIUzI1NiJ9.eyJzd<br/>WIiOiJ1c2VyMSIsImF1dGgiOiJVU0VSIiwiZXhwIjoxNjcyMTEzMDE5LCJpY<br/>XQiOjE2NzIxMDk0MTl9.hhddEesXd2HVb2CRl4SJZVJjspFRGRMG8yGi5QQcIXg | { <br/>""title" : "테스트1 수정", <br/>""content" : "제목이 곧 내용 수정"<br/>} | {<br/>"title": "테스트1 수정",<br/>"content": "제목이 곧 내용 수정",<br/>"username": "user1",<br/>"createdAt": "2022-12-27T11:52:16.828493",<br/>"modifiedAt": "2022-12-27T11:52:16.828493",<br/>"commentList": []<br/>}                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                        |
|  게시글 삭제   | /api/boards/{id}         | DELETE | Authorization : Bearer eyJhbGciOiJIUzI1NiJ9.eyJzd<br/>WIiOiJ1c2VyMSIsImF1dGgiOiJVU0VSIiwiZXhwIjoxNjcyMTEzMDE5LCJpY<br/>XQiOjE2NzIxMDk0MTl9.hhddEesXd2HVb2CRl4SJZVJjspFRGRMG8yGi5QQcIXg |                                                                    | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                        |
|   댓글 작성   | /api/boards/{id}/comment | POST   | Authorization : Bearer eyJhbGciOiJIUzI1NiJ9.eyJzd<br/>WIiOiJ1c2VyMSIsImF1dGgiOiJVU0VSIiwiZXhwIjoxNjcyMTEzMDE5LCJpY<br/>XQiOjE2NzIxMDk0MTl9.hhddEesXd2HVb2CRl4SJZVJjspFRGRMG8yGi5QQcIXg | {<br/>"comment" : "댓글 작성"<br/>}                                    | {<br/>"comment": "댓글 작성",<br/>"createdAt": "2022-12-27T12:01:30.493168",<br/>"modifiedAt": "2022-12-27T12:01:30.493168",<br/>"id": 2,<br/>"username": "user1"<br/>}                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                        |
|   댓글 수정   | /api/boards/{id}/comment | PUT    | Authorization : Bearer eyJhbGciOiJIUzI1NiJ9.eyJzd<br/>WIiOiJ1c2VyMSIsImF1dGgiOiJVU0VSIiwiZXhwIjoxNjcyMTEzMDE5LCJpY<br/>XQiOjE2NzIxMDk0MTl9.hhddEesXd2HVb2CRl4SJZVJjspFRGRMG8yGi5QQcIXg | {<br/>"comment" : "댓글 수정"<br/>}                                    | {<br/>"comment": "댓글 수정",<br/>"createdAt": "2022-12-27T12:01:30.493168",<br/>"modifiedAt": "2022-12-27T12:01:30.493168",<br/>"id": 2,<br/>"username": "user1"<br/>}                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                        |
|   댓글 삭제   | /api/boards/{id}/comment | DELETE | Authorization : Bearer eyJhbGciOiJIUzI1NiJ9.eyJzd<br/>WIiOiJ1c2VyMSIsImF1dGgiOiJVU0VSIiwiZXhwIjoxNjcyMTEzMDE5LCJpY<br/>XQiOjE2NzIxMDk0MTl9.hhddEesXd2HVb2CRl4SJZVJjspFRGRMG8yGi5QQcIXg |                                                                    | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                        |

### **질문 및 답변**
1. Q. 처음 설계한 API 명세서에 변경사항이 있었는지  A. : 처음 설계를 했을 당시 Lv.1 과제를 제출했을때 설계를 했었는데 처음에는 Blog 기준으로 만들었었는데 이번에는 Board로 만들어서 이름이 전부 다 바뀌었고 전체적으로 전부 다 변경된 것 같습니다. 첫 설계의 중요성은 처음에 잘 만들자??를 느꼈습니다.
2. Q. ERD를 먼저 설계한 후 Entity를 개발했을 떄 어떤 점이 도움이 됐는지  A. : 좀 더 편하게 만든 것 같습니다.
3. Q. JWT를 사용하여 인증/인가를 구현 했을 때의 장점  A. : 별도의 인증 저장소가 필요가 없다, REST 서비스로 제공 가능하다.
4. Q. 반대로 JWT를 사용한 인증/인가의 한계점은? A. : SecretKey가 노출되면 큰일날 것 같습니다. 
5. Q. 댓글이 달려있는 게시글을 삭제하려고 할 때 무슨 문제가 발생할까요? JPA가 아닌 Database 테이블 관점에서 해결방법이 무엇일까요? A. : 같이 삭제한다??..
6. Q. 5번과 같은 문제가 발생했을 때 JPA에서는 어떻게 해결할수 있을까요? A. : 게시글을 지우면 댓글도 같이 지워지게 코드를 짜면 될 것 같습니다.
7. Q. IoC/ DI에 대해 간략하게 설명하기 A. : IOC : 객체를 생성하고, 관리하고, 책임지고, 의존성을 관리해주는 컨테이너, DI : 어떤 객체기 사용하는 의존 객체를 직접 만들어 사용하는게 아니라, 주입받아 사용하는 방법
